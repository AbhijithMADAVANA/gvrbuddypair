{% extends 'shared/sidebars.html' %}
{% load static %}


{% block style %}
<link href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css" rel="stylesheet" />
<link rel="stylesheet" href="{% static 'datinghome/css/home.css' %}">
<style>
     :root{
    --primary-color:#EA9BE0;
    --secondary-color:#6E3767;
    --leftbar-color: #641259;
    }
    .head-bar{
      display: none;
    }
    .filter-bar{
        width: 100%;
    }
    .filter-container button{
        width: 45%;
    }
    .menu-bar-container{
    display: none;
    }

    .menu-bar{
        display: none;
        
    } 
    .options-list-items.active{
        background: white;
    }
    @media screen and (max-width: 455px){
      body{
        width: 500px;
      }

    }
    @media screen and (max-width: 766px){
      body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      
      height: 100%;

    }
    
    .menu-bar-container{
        width: 100%;
        height: 100px;
        background-color: transparent;
        display: flex;
        margin-top: -120px;
        z-index: 100;
        position: fixed;
        bottom: 0;
    }

    .menu-bar{
        height:70px;
        background-color: #fff;
        width: 80%;
        border-radius: 35px;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        padding: 30px;
        
    } 

    .menu-bar .menu-icon{
        height: 50px;
        width: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        
        color:#d368c5;
        border: 0;
        outline: 0;
        background-color: #fff;
    }
    .menu-bar .menu-icon i{
        font-size: 30px;
    }
    .menu-bar .menu-icon:focus{
        background-color: #d368c5;
        color:#fff;
    }
     
    .main-content{
      width: 100%;
      margin-left: 0;
      margin-right: 0;
    }
    /* mobile view head part*/
    .head-bar{
    height: 100px;
    
    display:flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    position: relative;
      width: 100%;
    }
    .home-left{
        width: 190px;
        height: 100px;
        display: flex;
        flex-direction: row;
        align-items: center;

    }
    .home-right{
        width: 150px;
        height: 100px;
        display: flex;
        justify-content: flex-start;
        align-items: center;
        gap: 10px;

    }
    .home-left .home-menu{
        width: 60px;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 25px;
        color:var(--secondary-color);
    }
    .home-left .home-head{
        width: 140px;
        height: 100%;
        display: flex;
        justify-content: flex-start;
        align-items: center;
        color:#641259;
    }
    .home-right .home-notification{
        height: 60px;
        width: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        font-size: 30px;
        border: 1px solid var(--primary-color);
        color: var(--secondary-color);
    }
    .dot{
        height: 10px;
        width: 10px;
        background-color: #fff;
        border-radius: 50%;
        border: 4px solid var(--secondary-color);
        margin-left: -15px;
        margin-top: -15px;
    }
    .home-profile{
        height: 55px;
        width: 55px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .home-profile img{
        height: 55px;
        width: 55px;
        border-radius: 50%;
    }
    button{
        border: none;
        outline:none;
        background: transparent;
    }
    .profile .overlay-text .action-icons {
      margin-left: 180px;

    } 
    .profile img{
      max-width: 100%; /* Full width on smaller screens */
    }
  }
</style>


{% endblock style %}

{% block maincontent %}
<!--mobile view head part-->
<div class="head-bar">
  <div class="home-left">
      <div class="home-menu"><button type="button" data-bs-toggle="offcanvas" data-bs-target="#staticBackdrop" aria-controls="staticBackdrop"><i class="fa-solid fa-bars"></i></button></div>
      <div class="home-head"><h2>Buddypair</h2></div>
  </div> 
  <div class="home-right">
      <div class="home-notification"><button type="button" class="icon-container menu" onclick="toggleFloatingNotification()"><i class="fa-regular fa-bell"></i></button><div class="dot"></div></div>
      <div class="home-profile"><img src="{% static 'datinghome/img/im7.jpg' %}"></div>
  </div>    
</div>
<!--mobile view head part-->
<style>
  .main-story-container {
    display: flex;
    align-items: flex-start; /* Align items to the top */
    justify-content: flex-start; /* Align items to the start horizontally if needed */
}

.story-container {
    display: flex;
    align-items: flex-start; /* Align each story item to the top */
}

.story {
    display: flex;
    flex-direction: column; /* Keep items in column format */
    align-items: center; /* Center horizontally but aligned to top */
}

</style>

<!--story section-->
<!-- <div class="main-story-container" style="top: 0;">
  <div class="horizontal-scroll">
      <button class="btn-scroll" id="btn-scroll-left" onclick="scrollHorizontally(1)">
          <i class='bx bx-chevron-left'></i>
      </button>
      <button class="btn-scroll" id="btn-scroll-right" onclick="scrollHorizontally(-1)">
          <i class='bx bx-chevron-right'></i>
      </button>
      <div class="story-container">
          {% if user_details %}
          <div class="story">
              <div class="story-circle your-story">
                  <img src="{% if user_details.profile_pic %}{{ user_details.profile_pic.url }}{% else %}{% static 'datinghome/img/default_pic.png' %}{% endif %}"
                       alt="Your Story"
                       onclick="showImageModal(this)"
                       style="cursor: pointer;">
                  <i class='bx bx-plus-circle'></i>
              </div>
              <span class="user-name">Your Story</span>
          </div>
          {% endif %}

          {% for user in other_users %}
          <div class="story">
              <div class="story-circle">
                  <img src="{% if user.profile_pic %}{{ user.profile_pic.url }}{% else %}{% static 'datinghome/img/default_pic.png' %}{% endif %}"
                       alt="{{ user.user.username }}"
                       onclick="showImageModal(this)"
                       style="cursor: pointer;">
              </div>
              <span class="user-name">{{ user.user.username }}</span>
          </div>
          {% empty %}
          <p>No stories to display.</p>
          {% endfor %}
      </div>
  </div>
</div> -->
<!-- Home/home.html -->
<!-- Home/home.html -->

<style>
  /* Modal container */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.9); /* Black w/ opacity */
}

/* Modal content (video) */
.modal-content {
    margin: auto;
    display: block;
    width: 80%;
    max-width: 700px;
}

/* Caption of Modal Video */
.caption {
    margin: auto;
    display: block;
    width: 80%;
    max-width: 700px;
    text-align: center;
    color: #ccc;
    padding: 10px 0;
}

/* The Close Button */
.close {
    position: absolute;
    top: 15px;
    right: 35px;
    color: #f1f1f1;
    font-size: 40px;
    font-weight: bold;
    cursor: pointer;
}

.close:hover,
.close:focus {
    color: #bbb;
    text-decoration: none;
    cursor: pointer;
}
</style>
<div class="main-story-container" style="top: 0;">
  <div class="horizontal-scroll">
      <!-- <button class="btn-scroll" id="btn-scroll-left" onclick="scrollHorizontally(1)">
          <i class='bx bx-chevron-left'></i>
      </button>
      <button class="btn-scroll" id="btn-scroll-right" onclick="scrollHorizontally(-1)">
          <i class='bx bx-chevron-right'></i>
      </button> -->
      <div class="story-container">
          <!-- First story for the logged-in user (show only if they have a video) -->
          <!-- Home/home.html -->
{% if user_details %}
<div class="story">
    <div class="story-circle your-story">
        {% if user_details.short_video and user_details.short_video.name %}
            <!-- Show video if available -->
            <video width="50" height="50" controls onclick="toggleVideo(this)" style="cursor: pointer;">
                <source src="{{ user_details.short_video.url }}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        {% else %}
            <!-- Show profile image if video is not available -->
            <img src="{% if user_details.profile_pic %}{{ user_details.profile_pic.url }}{% else %}{% static 'datinghome/img/default_pic.png' %}{% endif %}"
                 alt="Your Story"
                 style="cursor: pointer;">
        {% endif %}
        <i class='bx bx-plus-circle'></i>
    </div>
    <span class="user-name">Your Story</span>
</div>
{% endif %}


          <!-- Loop through all other users for the story section -->
          {% for user in other_users %}
    {% if user.short_video and user.short_video.name %}
    <div class="story">
        <div class="story-circle">
            <video width="50" height="50" onclick="showVideoModal('{{ user.short_video.url }}', '{{ user.user.username }}')" style="cursor: pointer;">
                <source src="{{ user.short_video.url }}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <span class="user-name">{{ user.user.username }}</span>
    </div>
    {% endif %}
          {% empty %}
          <p>No stories to display.</p>
          {% endfor %}
      </div>
  </div>
</div>


<!-- Modal for Video Playback -->
<div id="videoModal" class="modal">
  <span class="close">&times;</span>
  <video class="modal-content" id="modalVideo" controls>
      <source id="videoSource" src="" type="video/mp4">
      Your browser does not support the video tag.
  </video>
  <div id="videoCaption" class="caption"></div>
</div>

<script>
  // Get the modal elements
  var videoModal = document.getElementById("videoModal");
  var modalVideo = document.getElementById("modalVideo");
  var videoSource = document.getElementById("videoSource");
  var videoCaption = document.getElementById("videoCaption");
  
  // Function to display the video in the modal
  function showVideoModal(videoUrl, caption) {
      videoModal.style.display = "block"; // Show the modal
      videoSource.src = videoUrl; // Set the video source
      modalVideo.load(); // Load the new video
      videoCaption.innerHTML = caption; // Set the caption text
  }
  
  // Get the <span> element that closes the modal
  var closeModalButton = document.getElementsByClassName("close")[0];
  
  // When the user clicks on <span> (x), close the modal
  closeModalButton.onclick = function() { 
      videoModal.style.display = "none"; // Hide the modal
      modalVideo.pause(); // Pause the video
  }
  
  // Close the modal when clicking anywhere outside of the modal content
  window.onclick = function(event) {
      if (event.target == videoModal) {
          videoModal.style.display = "none"; // Hide the modal
          modalVideo.pause(); // Pause the video
      }
  }
  </script>
  
 <style>
  .filter-container a {
    margin-right: 15px; /* Space between the buttons horizontally */
    margin-bottom: 10px; /* Space between the buttons vertically (if needed) */
    text-decoration: none; /* Remove underline from links */
  }
  
  .filter-container a:last-child {
    margin-right: 0; /* Remove margin from the last button */
  }
</style>

<div class="filter-bar">
  <div class="filter-container">
    <!-- Location Filter -->
    <a href="?filter=Location" style="margin-right: 30%;">
      <button type="button" id="location-tab" class="options-list-items {% if request.GET.filter == 'Location' %}active{% else %}inactive{% endif %}">
        Location
      </button>
    </a>
    <!-- Designation Filter -->
    <a href="?filter=Designation" style="margin-right: 30%;">
      <button type="button" id="designation-tab" class="options-list-items {% if request.GET.filter == 'Designation' %}active{% else %}inactive{% endif %}">
        Designation
      </button>
    </a>
    <!-- Qualification Filter -->
    <a href="?filter=Qualification">
      <button type="button" id="qualification-tab" class="options-list-items {% if request.GET.filter == 'Qualification' %}active{% else %}inactive{% endif %}">
        Qualification
      </button>
    </a>
  </div>
</div>
<div id="" class="profile-view">
  <div class="container">
    <div class="row">
      {% for user in users %}
      <!-- Displaying each user's profile with Bootstrap column classes -->
      <div class="col-md-6">
        <a href="{% url 'dating_profiles:profile' user.user.id %}">
        <div class="profile">
          <img src="{{ user.profile_pic.url }}" alt="{{ user.user.username }}" class="img-fluid" style="width: 80%;">
          <div class="overlay-text">
            <span class="status">{{ user.user.is_online|yesno:"Online,Offline" }}</span>
            <div class="action-icons">
              <div class="icon"><button type="button"><i class="fa-solid fa-thumbs-up"></i></button></div>
              <div class="icon"><button type="button"><i class='bx bxs-message-rounded'></i></button></div>
              <div class="icon"><button type="button"><i class='bx bx-dots-horizontal-rounded'></i></button></div>
            </div>
            <div class="pro-info">
              <h3>{{ user.user.username }}</h3>
              <p>{{ user.job_details.designation }}, {{ user.user_location.address_details.town }}</p>
            </div>
          </div>
        </div>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
</div>



<!--bottom navbar section-->
<div class="menu-bar-container">
  <div class="menu-bar">
    <button class="menu-icon">
        <i class='bx bxs-home'></i>
    </button>
    <button class="menu-icon">
        <i class='bx bxs-compass'></i>
    </button>
    <button class="menu-icon"><img src="{% static 'datinghome/img/rainbow.png' %}" alt="" style="width: 40px;height: 40px;"></button>
    <button class="menu-icon"><i class="fa-solid fa-users"></i></button>
    <button class="menu-icon">
        <i class='bx bx-message-rounded'></i>
    </button>
  </div>
</div>  
<!--navbar section -->

{% endblock maincontent %}

{% block js %}

<!-- <script src="{% static 'datinghome/js/home.js' %}"></script> -->


{% endblock %}